Lyte.Component.register("lyte-accordion",{_template:'<template tag-name="lyte-accordion">\n\t<lyte-yield yield-name="yield">\n\n\t</lyte-yield>\n</template>',_dynamicNodes:[{type:"insertYield",position:[1]}],_observedAttributes:["ltPropDuration","ltPropHeight","ltPropExclusive","ltPropYield","ltPropDynamic"],data:function(){return{ltPropDuration:Lyte.attr("string",{default:"0.2s"}),ltPropHeight:Lyte.attr("string"),ltPropExclusive:Lyte.attr("boolean",{default:!0}),ltPropYield:Lyte.attr("boolean",{default:!0}),ltPropDynamic:Lyte.attr("boolean",{default:!1})}},execAndCheck:function(t,e){var i,n;return i=_lyteAccordion.findProperParent(e.target).parentElement,n=void 0==(n=this.executeMethod(t,e,i,this))||n},initiateClose:function(t,e,i){window.requestAnimationFrame(function(){t.style.height=t.getBoundingClientRect().height+"px",window.requestAnimationFrame(function(){t.style.height="0px"})}),t.style.overflow="hidden",t._close=!0,t.parentElement.classList.remove("lyteAccordionActive"),e&&$L.fastdom.measure(function(){e.call(this,i)},this)},execNonRetCalls:function(t){this.getMethods(t[0])&&this.executeMethod.apply(this,t)},isVisible:function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},scrollIntoView:function(t){if(t&&this.isVisible(t)&&t){var e,i=this.$node.getBoundingClientRect().height,n=this.$node.scrollTop+i,o=t.offsetTop,r=t.getAttribute("map"),a=o+t.getBoundingClientRect().height;n<a&&(this.$node.scrollTop=this.$node.scrollTop+(a-n)),e=window.requestAnimationFrame(this.scrollIntoView.bind(this,t)),Lyte.objectUtils(this.getData("rAFMap"),"add",r,e)}},dynamic:function(t){var e;t.style.height="auto",e=t.getBoundingClientRect().height,window.requestAnimationFrame(function(){t.style.height="0px",window.requestAnimationFrame(function(){t.style.height=e+"px"})})},static:function(t,e){var i=e.height;this.getData("heights")[t.getAttribute("map")].conf&&i?t.style.height=i:t.style.height=this.getData("heights")[t.getAttribute("map")].height},calculate:function(t,e){var i=this.getData("ltPropDynamic");t.parentElement.classList.add("lyteAccordionActive"),i?this.dynamic(t):this.static(t,e)},initiateOpen:function(t,e,i){var n;this.calculate(t,e),t._close=!1,t.style.overflow="hidden",t.parentElement.classList.add("lyteAccordionActive"),n=_lyteAccordion.findProperParent(i.target),$L.fastdom.measure(function(){this.scrollIntoView(t),this.execNonRetCalls(["onOpen",i,n.parentElement,this]),this.execNonRetCalls(["onChanged",i,n.parentElement,this])},this)},didDestroy:function(){for(var t=this.$node.querySelectorAll("lyte-accordion-item"),e=0;e<t.length;e++)t[e].getAttribute("lyte-shortcut")&&t[e].setAttribute("lyte-shortcut",JSON.stringify({}))},cancelFrame:function(t){var e=t.getAttribute("map"),i=t._close,n=this.getData("ltPropDynamic");window.cancelAnimationFrame(this.getData("rAFMap")[e]),t.style.overflow=i?"hidden":"auto",n&&!i&&(t.style.height="auto")},setEvent:function(t){t&&t.addEventListener("transitionend",this.cancelFrame.bind(this,t))},calculateHeight:function(t,e){var i=t.style.height;this.getData("heights")[e]={},i?(this.getData("heights")[e].height=i,this.getData("heights")[e].conf=!1):(this.getData("heights")[e].height=t.getBoundingClientRect().height-parseFloat(window.getComputedStyle(t).paddingTop)-parseFloat(window.getComputedStyle(t).paddingBottom)+"px",this.getData("heights")[e].conf=!0)},readHeights:function(){for(var t,e=this.$node.querySelector("lyte-yield").children,i=0,n=this.getData("ltPropDynamic");i<e.length;i++)"LYTE-ACCORDION-ITEM"===e[i].tagName&&(t=e[i].querySelector("lyte-accordion-body"))&&(this.setEvent(t),n||this.calculateHeight(t,i),e[i].classList.contains("lyteAccordionActive")&&this.getData("ltPropExclusive")&&(this.flag=i))},maintainHeightOrder:function(t,e){var i=this.getData("ltPropDynamic");t._close=!1,t.style.height=i?"auto":this.getData("heights")[e].conf&&this.getData("ltPropHeight")?this.getData("ltPropHeight"):this.getData("heights")[e].height},writeHeights:function(){for(var t,e=this.$node.querySelector("lyte-yield").children,i=this.getData("ltPropExclusive"),n=0;n<e.length;n++)"LYTE-ACCORDION-ITEM"===e[n].tagName&&(t=e[n].querySelector("lyte-accordion-body"))&&(t.setAttribute("map",n),e[n].classList.contains("lyteAccordionActive")?i&&this.flag!=n?(t._close=!0,e[n].classList.remove("lyteAccordionActive"),t.style.height="0px"):this.maintainHeightOrder(t,n):(t._close=!0,t.style.height="0px"))},executeAfterRender:function(){this.execNonRetCalls(["afterRender",this])},attachScrolls:function(){for(var t,e=this.$node.querySelector("lyte-yield").children,i=0;i<e.length;i++)"LYTE-ACCORDION-ITEM"===e[i].tagName&&(t=e[i].querySelector("lyte-accordion-body"))&&(t.style.overflow="auto")},getAllHeights:function(){this.setData("heights",{}),$L.fastdom.measure(this.attachScrolls,this),$L.fastdom.measure(this.readHeights,this),$L.fastdom.mutate(this.writeHeights,this),$L.fastdom.measure(this.executeAfterRender,this)},didConnect:function(){this.setData("rAFMap",{}),this.getAllHeights()},getConfiguration:function(){var t={};return t.transition=this.getData("ltPropDuration"),t.height=this.getData("ltPropHeight"),t.exclusive=this.getData("ltPropExclusive"),t}});var _lyteAccordion={findProperParentS:function(t){for(var e,i,n=[],o=!1;"LYTE-YIELD"!=t.tagName&&"HTML"!=t.tagName;)if(e=t,n.push(t),!(t=t.parentElement))return null;for(i=n.length-1;i>-1;i--)if("LYTE-ACCORDION-HEADER"===n[i].tagName||1===n.length&&"LYTE-ACCORDION-ITEM"===n[i].tagName){o=!0;break}return o?e.children[0]:null},findProperParent:function(t){var e;if(t){for(;"LYTE-YIELD"!=t.tagName&&"HTML"!=t.tagName;)if(e=t,!(t=t.parentElement))return{};return"LYTE-ACCORDION-HEADER"===(e.children[0]||{}).tagName?e.children[0]:void 0}}};document.addEventListener("click",function(t){var e,i,n,o,r,a,l,s,c,h,d,g,u,y=_lyteAccordion.findProperParentS(t.target),f=0;if(y){for(e=y;"HTML"!=e.tagName&&"LYTE-ACCORDION"!=e.tagName;)if(!(e=e.parentElement))return;if("HTML"!=e.tagName){for(n=(i=e.querySelector("lyte-yield")).children,o=!0;f<n.length;f++)if(n[f].querySelector("lyte-accordion-header")==y){o=!1;break}if(!o){if(r=i.children[f].querySelector("lyte-accordion-body"),s=(l=(a=i.parentElement.component).getConfiguration()).transition,!r||"LYTE-ACCORDION-BODY"!=r.tagName){if(l&&l.exclusive&&(c=a.$node.querySelector(".lyteAccordionActive"))&&(h=c.querySelector("lyte-accordion-body")))if(h.style.transitionDuration=s,a.getMethods("onBeforeClose")){if(!(d=a.execAndCheck("onBeforeClose",t)))return;a.initiateClose(h,function(t){this.execNonRetCalls(["onClose",t,_lyteAccordion.findProperParent(t.target).parentElement,this])},t)}else a.initiateClose(h,function(t){this.execNonRetCalls(["onClose",t,_lyteAccordion.findProperParent(t.target).parentElement,this])},t);return i.children[f].classList.contains("lyteAccordionActive")?i.children[f].classList.remove("lyteAccordionActive"):i.children[f].classList.add("lyteAccordionActive"),void $L.fastdom.measure(function(){a.execNonRetCalls(["onChanged",t,_lyteAccordion.findProperParent(t.target).parentElement,a])})}if(g=window.getComputedStyle(r).height,s&&(r.style.transitionDuration=s,(c=a.$node.querySelector(".lyteAccordionActive"))&&(h=c.querySelector("lyte-accordion-body"))&&(h.style.transitionDuration=s)),u=a.$node.querySelector(".lyteAccordionActive"),l&&l.exclusive&&u&&u!=r.parentElement){if((h=u.querySelector("lyte-accordion-body"))&&a.getMethods("onBeforeClose")){if(!(d=a.execAndCheck("onBeforeClose",t)))return;a.initiateClose(h,function(t){this.execNonRetCalls(["onClose",t,_lyteAccordion.findProperParent(t.target).parentElement,this])},t)}else(h=u.querySelector("lyte-accordion-body"))&&a.initiateClose(h,function(t){this.execNonRetCalls(["onClose",t,_lyteAccordion.findProperParent(t.target).parentElement,this])},t);u.classList.contains("lyteAccordionActive")&&u.classList.remove("lyteAccordionActive")}if("0px"==g)if(a.getMethods("onBeforeOpen")){if(d=a.execAndCheck("onBeforeOpen",t),l=a.getConfiguration(),!d)return;a.initiateOpen(r,l,t)}else a.initiateOpen(r,l,t);else if(a.getMethods("onBeforeClose")){if(!(d=a.execAndCheck("onBeforeClose",t)))return;a.initiateClose(r,function(t){var e=_lyteAccordion.findProperParent(t.target);this.execNonRetCalls(["onClose",t,e.parentElement,this]),this.execNonRetCalls(["onChanged",t,e.parentElement,this])},t)}else a.initiateClose(r,function(t){var e=_lyteAccordion.findProperParent(t.target);this.execNonRetCalls(["onClose",t,e.parentElement,this]),this.execNonRetCalls(["onChanged",t,e.parentElement,this])},t)}}}},!0),_lyteUiUtils.registeredCustomElements["lyte-accordion-item"]||(_lyteUiUtils.registeredCustomElements["lyte-accordion-item"]=!0,Lyte.createCustomElement("lyte-accordion-item",{static:{observedAttributes:{get:function(){return["lyte-shortcut"]}}},attributeChangedCallback:function(t,e,i,n){if("function"==typeof shortcut){if(!i)return;if(!(i=JSON.parse(i)).key)return;var o=i.key,r=i.type,a=i.wait;e||(e={}),shortcut.push({newKey:o,type:r,wait:a,oldKey:e.key,value:this})}}}));