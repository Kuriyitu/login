Lyte.Component.register("lyte-tabs",{_template:'<template tag-name="lyte-tabs">\n\t<template is="if" value="{{ltPropYield}}"><template case="true">\n\t\t<lyte-yield yield-name="tabYield"></lyte-yield>\n\t</template></template>\n</template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"insertYield",position:[1]}]}},default:{}}],_observedAttributes:["ltPropYield","ltPropHover","ltPropActiveClass","ltPropPosition","ltPropCloseIcon","prevTarget","ltPropHeight","ltPropType","ltPropMaxWidth","ltPropTabStyle","ltPropMenuWrapperClass","menuLabels"],init:function(){this.$node.addTab=function(t){this.component.constructTabs(this,t)},this.$node.deleteTab=function(t){this.component.deleteTabContent(t)},this.$node.openTab=function(t){this.component.openTabContent(t)},this.$node.enableTab=function(t){this.component.enableTab(t)},this.$node.disableTab=function(t){this.component.disableTab(t)}},data:function(){return{ltPropYield:Lyte.attr("boolean",{default:!0}),ltPropHover:Lyte.attr("string",{default:"lyteTabHover"}),ltPropActiveClass:Lyte.attr("string",{default:"lyteTabActive"}),ltPropPosition:Lyte.attr("object",{default:{pos:"top",align:"left"}}),ltPropCloseIcon:Lyte.attr("boolean",{default:!1}),prevTarget:Lyte.attr("object",{default:null}),ltPropHeight:Lyte.attr("string",{default:"400px"}),ltPropType:Lyte.attr("string"),ltPropMaxWidth:Lyte.attr("string",{default:"90%"}),ltPropTabStyle:Lyte.attr("string"),ltPropMenuWrapperClass:Lyte.attr("string"),menuLabels:Lyte.attr("array",{default:[]})}},didConnect:function(){this.initialFunc()},didDestroy:function(){this.$node.checkTabs&&(clearTimeout(this.$node.checkTabs),this.$node.checkTabs=!1)},initialFunc:function(){if(this.$node.childElementCount>1||"LYTE-TAB"===this.$node.children[0].tagName){this.checkTabStyle(),this.$node.style.height=this.getData("ltPropHeight");var t=this.$node.querySelector("lyte-tab-head");t.classList.add("lyteTabNav"),"collapse"==this.getData("ltPropType")&&t.classList.add("lyteTabOverflowV");var e,a=this.getData("ltPropPosition"),o=t.querySelectorAll("lyte-tab-title"),i=this.getContent(this.$node.querySelector("lyte-tab-body").children),s=this.getData("ltPropActiveClass");this.setPosition(a),this.getData("ltPropCloseIcon")&&this.createCloseIcon(t.querySelectorAll("lyte-tab-title"));t.addEventListener("click",function(t){this.showTab(t)}.bind(this),!0),t.addEventListener("mouseover",function(t){this.mouseOver(t)}.bind(this),!0),t.addEventListener("mouseout",function(t){this.mouseOut(t)}.bind(this),!0);for(var l=0;l<o.length;l++)o[l].classList.contains(s)&&(e=l);for(l=0;l<i.length;l++)!e||e!==l&&o[e].getAttribute("lt-prop-id")!==i[l].id?i[l].classList.add("lyteTabHide"):(this.executeOnBeforeOpen(o[e],o[e].getAttribute("lt-prop-id"),null),i[l].classList.add("lyteTabShow"),this.executeOnOpen(o[e],o[e].getAttribute("lt-prop-id")));e||(e=0,this.executeOnBeforeOpen(o[0],o[0].getAttribute("lt-prop-id"),null),o[0].classList.add(s),i[0].classList.remove("lyteTabHide"),i[0].classList.add("lyteTabShow"),this.executeOnOpen(o[0],o[0].getAttribute("lt-prop-id"))),this.setData("prevTarget",o[e]),$L.fastdom.measure(function(){if("auto"==this.getData("ltPropHeight"))"left"!==a.pos&&"right"!==a.pos||(this.$node.querySelector(".lyteTabNav").style.height="auto",this.$node.querySelector("lyte-tab-body").style.height="auto"),"top"!==a.pos&&"bottom"!==a.pos||(this.$node.querySelector("lyte-tab-body").style.height="auto"),this.makeAlignment(this.getData("ltPropPosition"));else{var t=window.getComputedStyle(this.$node),e=(t.borderTop?parseFloat(t.borderTop):0)+(t.borderBottom?parseFloat(t.borderBottom):0),o=this.$node.querySelector(".lyteTabNav").getBoundingClientRect().height,i=parseInt(t.height)-e;$L.fastdom.mutate(function(){"left"!==a.pos&&"right"!==a.pos||(this.$node.querySelector(".lyteTabNav").style.height=i+"px",this.$node.querySelector("lyte-tab-body").style.height=i+"px"),"top"!==a.pos&&"bottom"!==a.pos||(this.$node.querySelector("lyte-tab-body").style.height=i-o+"px"),this.makeAlignment(this.getData("ltPropPosition"))},this)}},this)}else console.error("No content detected")},checkTabStyle:function(){"nested"===this.getData("ltPropTabStyle")&&this.$node.classList.add("lyteNestedTab")},onPositionChange:function(){var t=this.$node;t.classList.remove("lyteTabDefaultLeft","lyteTabDefaultRight","lyteTabDefaultTop","lyteTabDefaultBottom");var e=t.querySelector("lyte-tab-head"),a=t.querySelector("lyte-tab-body"),o=t.querySelectorAll("lyte-tab-title");e.classList.remove("lyteTabAlignStart","lyteTabAlignEnd","lyteTabAlignCenter"),e.removeAttribute("style"),a.removeAttribute("style"),o[0].style.marginLeft="",o[0].style.marginTop="";for(var i=0;i<o.length;i++)o[i].style.float="";t=null,e=null,o=null,a=null,this.initialFunc()}.observes("ltPropPosition"),onHeightChange:function(){this.$node.style.height=this.getData("ltPropHeight"),this.setHeight(this.getData("ltPropPosition"))}.observes("ltPropHeight"),showTab:function(t){for(var e=t.target.correspondingElement||t.target;e&&e.parentNode&&"LYTE-TAB-TITLE"!=e.tagName;)e=e.parentNode;if(e&&"HTML"!=e.tagName&&!e.isEqualNode(document)&&"LYTE-TAB-TITLE"==e.tagName){var a=e.getAttribute("lt-prop-id");if(t.target.classList.contains("lyteTabCloseIcon")){if(!this.deleteTabContent(a))return;if(this.makeAlignment(this.getData("ltPropPosition")),!(e=this.$node.querySelector("lyte-tab-head").querySelectorAll("lyte-tab-title").length>0?this.$node.querySelector("lyte-tab-head").querySelectorAll("lyte-tab-title")[0]:null))return void this.setData("prevTarget",null);a=e.getAttribute("lt-prop-id")}this.openTabContent(e)}},mouseOver:function(t){for(var e=t.target.correspondingElement||t.target;e&&e.parentNode&&"LYTE-TAB-TITLE"!=e.tagName;)e=e.parentNode;if(e&&"HTML"!=e.tagName&&!e.isEqualNode(document)){var a=this.getData("ltPropHover");$L(e).addClass(a)}},mouseOut:function(t){for(var e=t.target.correspondingElement||t.target;e&&e.parentNode&&"LYTE-TAB-TITLE"!=e.tagName;)e=e.parentNode;if(e&&"HTML"!=e.tagName&&!e.isEqualNode(document)){var a=this.getData("ltPropHover");$L(e).removeClass(a)}},getContent:function(t){for(var e=[],a=0;a<t.length;a++)"LYTE-TAB-CONTENT"==t[a].tagName&&e.push(t[a]);return e},getHeader:function(t){for(var e=[],a=0;a<t.length;a++)"LYTE-TAB-TITLE"==t[a].tagName&&e.push(t[a]);return e},constructTabs:function(t,e){var a,o="",i="",s=!1,l=document.createElement("lyte-tab-title"),n=document.createElement("lyte-tab-content");"object"==typeof e&&"LYTE-TAB"===e.tagName?(o=e.getAttribute("lt-prop-title"),i=e.innerHTML,a=e.getAttribute("lt-prop-id")):(o=e.title,i=e.content,a=e.id,s=!0),a||(a=this.generateId(o)),l.innerHTML=o,n.innerHTML=i,l.setAttribute("lt-prop-id",a),n.id=a,n.classList.add("lyteTabHide"),t.querySelector("lyte-tab-head").append(l),t.querySelector("lyte-tab-body").append(n),s&&(this.getData("ltPropCloseIcon")&&this.createCloseIcon(new Array(l)),this.makeAlignment(this.getData("ltPropPosition")))},deleteTabContent:function(t){if(t){var e=!0;if(this.getMethods("onBeforeDelete")&&(e=void 0===(e=this.executeMethod("onBeforeDelete",t,this.$node))||e),!e)return!1;for(var a=this.$node.querySelector("#"+t),o=this.$node.querySelector("lyte-tab-head"),i=o.querySelectorAll("lyte-tab-title"),s=0;s<i.length;s++)if(i[s].getAttribute("lt-prop-id")===t){i[s].classList.contains("lyteTabCustomTitleWidth")&&!0,o.removeChild(i[s]),a&&this.$node.querySelector("lyte-tab-body").removeChild(a);break}return this.getMethods("onDelete")&&this.executeMethod("onDelete",t,this.$node),!0}},enableTab:function(t){if(t){if("string"==typeof t)for(var e=this.$node.querySelector("lyte-tab-head").querySelectorAll("lyte-tab-title"),a=0;a<e.length;a++)if(e[a].getAttribute("lt-prop-id")===t){e[a].classList.contains("lyteTabDisable")&&(e[a].classList.remove("lyteTabDisable"),e[a].classList.contains("lyteTabForceHide")&&Lyte.arrayUtils(this.getData("menuLabels"),"push",e[a].textContent));break}"object"==typeof t&&t.classList.contains("lyteTabDisable")&&(t.classList.remove("lyteTabDisable"),t.classList.contains("lyteTabForceHide")&&Lyte.arrayUtils(this.getData("menuLabels"),"push",t.textContent))}},disableTab:function(t){if(t){if("string"==typeof t)for(var e=this.$node.querySelector("lyte-tab-head").querySelectorAll("lyte-tab-title"),a=0;a<e.length;a++)if(e[a].getAttribute("lt-prop-id")===t){if(!e[a].classList.contains("lyteTabDisable"))if(e[a].classList.add("lyteTabDisable"),e[a].classList.contains("lyteTabForceHide"))-1!=(o=this.getData("menuLabels").indexOf(e[a].textContent))&&Lyte.arrayUtils(this.getData("menuLabels"),"removeAt",o,1);break}var o;if("object"==typeof t&&!t.classList.contains("lyteTabDisable"))if(t.classList.add("lyteTabDisable"),t.classList.contains("lyteTabForceHide"))-1!=(o=this.getData("menuLabels").indexOf(t.textContent))&&Lyte.arrayUtils(this.getData("menuLabels"),"removeAt",o,1)}},openTabContent:function(t){if(t){var e;if("string"==typeof t)for(var a=this.$node.querySelector("lyte-tab-head").querySelectorAll("lyte-tab-title"),o=this.$node.querySelector("#"+t),i=0;i<a.length;i++)if(a[i].getAttribute("lt-prop-id")===t){if(a[i].classList.contains(this.getData("ltPropActiveClass")))return;if(e=a[i],!this.executeOnBeforeOpen(e,t,this.getData("prevTarget")?this.getData("prevTarget").getAttribute("lt-prop-id"):null))return;this.hideAll(),e.classList.add(this.getData("ltPropActiveClass")),o&&(o.classList.remove("lyteTabHide"),o.classList.add("lyteTabShow")),this.executeOnOpen(e,t),this.setData("prevTarget",e);break}if("object"==typeof t){if(t.classList.contains(this.getData("ltPropActiveClass")))return;e=t;var s=t.getAttribute("lt-prop-id");o=this.$node.querySelector("#"+s);if(!this.executeOnBeforeOpen(t,s,this.getData("prevTarget")?this.getData("prevTarget").getAttribute("lt-prop-id"):null))return;this.hideAll(),t.classList.add(this.getData("ltPropActiveClass")),o&&(o.classList.remove("lyteTabHide"),o.classList.add("lyteTabShow")),this.executeOnOpen(t,s),this.setData("prevTarget",t)}"collapse"==this.getData("ltPropType")&&this.getData("menuLabels").indexOf(e.textContent)>-1&&this.collapseHeader(!0)}},createCloseIcon:function(t){for(var e=0;e<t.length;e++)if(!t[e].addedCloseIcon){var a=document.createElement("span");a.innerHTML=t[e].innerHTML,t[e].innerHTML="",t[e].appendChild(a);var o=document.createElement("span");o.classList.add("lyteTabCloseIcon"),t[e].appendChild(o)}},setPosition:function(t){switch(t.pos){case"left":this.$node.classList.add("lyteTabDefaultLeft");break;case"right":this.$node.classList.add("lyteTabDefaultRight");break;case"top":this.$node.classList.add("lyteTabDefaultTop");break;case"bottom":this.$node.classList.add("lyteTabDefaultBottom")}},checkHeightOnResize:function(){this.$node.getBoundingClientRect().height!=this.$node.querySelector(".lyteTabNav").getBoundingClientRect().height+this.$node.querySelector("lyte-tab-body").getBoundingClientRect().height&&this.setHeight(this.getData("ltPropPosition"))},setHeight:function(t){"auto"==this.getData("ltPropHeight")?("left"!==t.pos&&"right"!==t.pos||(this.$node.querySelector(".lyteTabNav").style.height="auto",this.$node.querySelector("lyte-tab-body").style.height="auto"),"top"!==t.pos&&"bottom"!==t.pos||(this.$node.querySelector("lyte-tab-body").style.height="auto"),this.makeAlignment(this.getData("ltPropPosition"))):$L.fastdom.measure(function(){var e=window.getComputedStyle(this.$node),a=(e.borderTop?parseFloat(e.borderTop):0)+(e.borderBottom?parseFloat(e.borderBottom):0),o=this.$node.querySelector(".lyteTabNav").getBoundingClientRect().height,i=parseInt(e.height)-a;$L.fastdom.mutate(function(){"left"!==t.pos&&"right"!==t.pos||(this.$node.querySelector(".lyteTabNav").style.height=i+"px",this.$node.querySelector("lyte-tab-body").style.height=i+"px"),"top"!==t.pos&&"bottom"!==t.pos||(this.$node.querySelector("lyte-tab-body").style.height=i-o+"px"),this.makeAlignment(this.getData("ltPropPosition"))},this)},this)},hideAll:function(){for(var t=this.$node.querySelector("lyte-tab-head").querySelectorAll("lyte-tab-title"),e=this.getContent(this.$node.querySelector("lyte-tab-body").children),a=this.getData("ltPropActiveClass"),o=0;o<t.length;o++)t[o].classList.contains(a)&&t[o].classList.remove(a);for(var i=0;i<e.length;i++)e[i].classList.contains("lyteTabShow")&&(e[i].classList.remove("lyteTabShow"),e[i].classList.add("lyteTabHide")),e[i].classList.contains("lyteTabHide")||e[i].classList.add("lyteTabHide"),$L(e[i]).hasClass("lyteTabHide")||$L(e[i]).addClass("lyteTabHide")},customizeTitleTab:function(t){$L.fastdom.measure(function(){var e=this.$node.querySelector("lyte-tab-head"),a=this.getWidth(e,!1);if("top"===t||"bottom"===t){var o=0,i=0,s=e.querySelectorAll("lyte-tab-title");"collapse"==this.getData("ltPropType")&&$L.fastdom.measure(function(){for(var t=0;t<s.length;t++)o+=this.getWidth(s[t],!0,!0);o>a&&this.collapseHeader()},this)}if("afterDelete"===t){s=e.querySelectorAll("lyte-tab-title"),i=a/s.length;$L.fastdom.mutate(function(){for(var t=0;t<s.length;t++)s[t].style.width=i+"px"})}},this)},collapseHeader:function(t){var e=this.$node.querySelector("lyte-tab-head"),a=this.getWidth(e,!1),o=e.offsetHeight,i=-1!=this.getData("ltPropMaxWidth").indexOf("%")?parseInt(this.getData("ltPropMaxWidth"))*a/100:parseFloat(this.getData("ltPropMaxWidth")),s=e.querySelectorAll("lyte-tab-title"),l=0,n=-1,r=Array.from(s).findIndex(function(t){return t.classList.contains("lyteTabActive")}),c=[];if(t)for(var d=0;d<s.length;d++)s[d].classList.contains("lyteTabForceHide")&&s[d].classList.remove("lyteTabForceHide");l+=this.getWidth(s[r],!0,!0);for(d=0;d<s.length;d++)if(d!=r&&(l+=this.getWidth(s[d],!0,!0))>i){n=d;break}if(n>-1&&n<s.length){for(d=n;d<s.length;d++)d==r?r>0&&!s[d-1].classList.contains("lyteTabForceHide")&&($L(s[d-1]).addClass("lyteTabForceHide"),$L(s[d-1]).hasClass("lyteTabDisable")||c.push(s[d-1].textContent)):($L(s[d]).addClass("lyteTabForceHide"),$L(s[d]).hasClass("lyteTabDisable")||c.push(s[d].textContent));if(this.$node.querySelector("#lyteTabMenu"))Lyte.arrayUtils(this.getData("menuLabels"),"removeAt",0,this.getData("menuLabels").length),Lyte.arrayUtils(this.getData("menuLabels"),"push",c);else{var h=document.createElement("span");h.id="moreMenu";var u=this.createUniqueSlector();h.classList.add(u),h.appendChild(document.createElement("span")),e.appendChild(h),this.createMenu(c,u,"init"),t||"bottom"===this.getData("ltPropPosition").pos&&(e.style.top=e.offsetTop+(Math.ceil(o/2)-1)+"px")}}else-1==n&&this.removeMenu()},createUniqueSlector:function(){for(var t=document.querySelectorAll("lyte-tabs"),e=0;e<t.length;e++)if(t[e].isEqualNode(this.$node))return"menuSel_"+e},createMenu:function(t,e,a){if("init"==a){var o=document.createElement("lyte-menu");o.id="lyteTabMenu",this.setData("menuLabels",t),o.ltProp({content:this.getData("menuLabels"),query:"."+e,event:"click",callout:!0}),this.getData("ltPropMenuWrapperClass")&&o.ltProp({wrapperClass:this.getData("ltPropMenuWrapperClass")}),o.setMethods({onMenuClick:function(t,e,a,o,i){for(var s,l=arguments[0],n=arguments[2].parentElement.component,r=arguments[3].parentElement.querySelectorAll("lyte-tab-title"),c=0;c<r.length;c++)if(r[c].textContent==l&&r[c].classList.contains("lyteTabForceHide")){s=r[c];break}s&&(s.classList.remove("lyteTabForceHide"),n.openTabContent(s)),n.getMethods("onMenuClick")&&n.executeMethod("onMenuClick",t,e,a,o,i,n,s)},onBeforeOpen:function(t,e,a){var o=t.parentElement.component;o.getMethods("onBeforeMenuOpen")&&o.executeMethod("onBeforeMenuOpen",t,e,a,o)},onOpen:function(t,e,a){var o=t.parentElement.component;o.getMethods("onMenuOpen")&&o.executeMethod("onMenuOpen",t,e,a,o)},onBeforeClose:function(t,e){var a=t.parentElement.component;a.getMethods("onBeforeMenuClose")&&a.executeMethod("onBeforeMenuClose",t,e,a)},onClose:function(t,e){var a=t.parentElement.component;a.getMethods("onMenuClose")&&a.executeMethod("onMenuClose",t,e,a)},beforeRender:function(t){var e=t.parentElement.component;e.getMethods("onBeforeMenuRender")&&e.executeMethod("onBeforeMenuRender",t,e)},afterRender:function(t){var e=t.parentElement.component;e.getMethods("onAfterMenuRender")&&e.executeMethod("onAfterMenuRender",t,e)}}),this.$node.appendChild(o)}},removeMenu:function(){var t=this.$node.querySelector("#lyteTabMenu");t&&(t.remove(),this.$node.querySelector("#moreMenu").remove()),this.setData("menuLabels",[])},onMenuLabelChange:function(){this.$node.querySelector("lyte-menu").ltProp({content:this.getData("menuLabels")})},makeAlignment:function(t){var e=this.$node.querySelector("lyte-tab-head");"left"!=t.align&&"top"!=t.align||e.classList.add("lyteTabAlignStart"),"right"!=t.align&&"bottom"!=t.align||("collapse"!=this.getData("ltPropType")||"top"!=t.pos&&"bottom"!=t.pos?e.classList.add("lyteTabAlignEnd"):e.classList.add("lyteTabRightCollapse")),"center"==t.align&&e.classList.add("lyteTabAlignCenter")},executeOnBeforeOpen:function(t,e,a){var o;return this.getMethods("onBeforeOpen")&&(o=this.executeMethod("onBeforeOpen",this.$node.querySelector("#"+e),this.$node.querySelector("#"+a),this,t,this.getData("prevTarget")?this.getData("prevTarget"):null)),void 0===o||o},executeOnOpen:function(t,e){this.getMethods("onOpen")&&this.executeMethod("onOpen",this.$node.querySelector("#"+e),this,t)},generateId:function(t){for(;-1!==t.indexOf(" ");)t=t.replace(" ","_");return t},getWidth:function(t,e,a){e=void 0==e||e;var o=getComputedStyle(t),i=parseInt(o.paddingLeft)+parseInt(o.paddingRight),s=0;return a&&(s=parseInt(o.marginLeft)+parseInt(o.marginRight)),parseFloat(o.width)+(e?0:-i)+s}}),_lyteUiUtils.registeredCustomElements["lyte-tab-title"]||(_lyteUiUtils.registeredCustomElements["lyte-tab-title"]=!0,Lyte.createCustomElement("lyte-tab-title",{static:{},connectedCallback:function(){var t=this.closest("lyte-tabs");"collapse"==t.getData("ltPropType")&&(t.checkTabs?(clearTimeout(t.checkTabs),t.checkTabs=!1):this.closest("lyte-tab-head").classList.add("lyteTabVH"),t.checkTabs=setTimeout(function(){var e=this.closest("lyte-tabs");if(e){for(var a=e.component,o=this.parentElement,i=a.getWidth(o,!1),s=0,l=o.querySelectorAll("lyte-tab-title"),n=-1,r=0;r<l.length;r++)s+=a.getWidth(l[r],!0,!0),l[r].classList.contains(a.getData("ltPropActiveClass"))&&(n=r);-1==n&&a.openTabContent(l[0]),s>i&&"collapse"==a.$node.ltProp("type")&&a.collapseHeader(),this.closest("lyte-tab-head").classList.remove("lyteTabVH")}t.checkTabs=!1}.bind(this),100))},disconnectedCallback:function(){var t=this.closest("lyte-tabs");t&&t.checkTabs&&(clearTimeout(t.checkTabs),t.checkTabs=!1,this.closest("lyte-tab-head").classList.remove("lyteTabVH"))}})),window.addEventListener("resize",function(){window._lyteUiUtils.tabResizeTriggered&&(clearTimeout(window._lyteUiUtils.tabResizeTriggered),window._lyteUiUtils.tabResizeTriggered=!1),window._lyteUiUtils.tabResizeTriggered=setTimeout(function(){for(var t=document.querySelectorAll("lyte-tabs"),e=0;e<t.length;e++)"collapse"==t[e].component.getData("ltPropType")&&t[e].component.collapseHeader(!0),t[e].component.checkHeightOnResize();window._lyteUiUtils.tabResizeTriggered=!1},50)});