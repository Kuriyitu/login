Lyte.Component.register("lyte-tooltip",{_template:'<template tag-name="lyte-tooltip">\n   \n</template>',_dynamicNodes:[],_observedAttributes:["ltPropId","ltPropClass","ltPropKeepAlive","eventListeners","tooltips"],init:function(){this._dir=_lyteUiUtils.getRTL(),this.getMethods("beforeRender")&&this.executeMethod("beforeRender",this.$node)},rtlfunc:function(t,e,o){if(this._dir&&"top"!=t&&"clientY"!=t){if(e)return"right"==t?o-e.left:"clientX"==t?o-e.clientX:o-e.right;if("left"==t)return"right";if("right"==t)return"left"}return e?e[t]:t},data:function(){return{ltPropId:Lyte.attr("string",{default:""}),ltPropClass:Lyte.attr("string",{default:""}),ltPropKeepAlive:Lyte.attr("boolean",{default:!1}),eventListeners:Lyte.attr("object",{default:{}}),tooltips:Lyte.attr("object",{default:{}})}},didConnect:function(){var t=document.body.querySelectorAll("lyte-tooltip");if(this._clickHide=this.clickHide,t.length>1)for(var e=0;e<t.length;e++)t[e].getAttribute("lt-prop-class")||t[e].getAttribute("lt-prop-id")||t[e]==this.$node||t[e].parentElement.removeChild(t[e]);var o=this.mousemove.bind(this);this.setData("eventListeners.mousemove",o),document.addEventListener("mousemove",o,!0),this._mousedown=this.mousedown.bind(this),this._mouseup=this.mouseup.bind(this),this._keydown=this.keydown.bind(this),this._toolscroll=this.tooltipScroll.bind(this),window.addEventListener("scroll",this._toolscroll,!0),document.addEventListener("keydown",this._keydown,!0),document.addEventListener("mousedown",this._mousedown,!0),document.addEventListener("touchstart",this._mousedown),this.getMethods("afterRender")&&this.executeMethod("afterRender",this.$node),$L.fastdom.measure(function(){var t="rtl"==window.getComputedStyle(this.$node).getPropertyValue("direction");$L.fastdom.mutate(function(){t&&(this.direction=!0)}.bind(this))}.bind(this)),this.$node.trigger=function(t){this.mousemove({target:t||document.body})}.bind(this)},tooltipScroll:function(t){var e=this.data.tooltips;for(var o in e)e[o].classList.add("lyteTooltipHidden")},mousedown:function(t){this._mousedownFlag=!0;var e=t.target.correspondingElement||t.target;"touchstart"==t.type&&t.touches.length>1||(e.classList.contains("lyteSliderHandler")&&(delete this.prevTooltipNode,this._slider=!0),this.closeAllTooltip(),document.addEventListener("mouseup",this._mouseup,!0))},mouseup:function(t){if(delete this._mousedownFlag,document.removeEventListener("mouseup",this._mouseup,!0),this._slider){delete this._slider;var e=t.target.correspondingElement||t.target;e.classList.contains("lyteSliderHandler")&&this.mousemove({target:e})}},keydown:function(t){delete this.prevTooltipNode,this.closeAllTooltip()},tooltipOpenCallback:function(t,e){t.onTooltipShow&&t.onTooltipShow.apply(this,arguments),this.getMethods("onTooltipShow")&&this.executeMethod("onTooltipShow",t,e,t.tooltip)},tooltipCloseCallback:function(t){t.onTooltipHide&&t.onTooltipHide.apply(this,arguments),this.getMethods("onTooltipHide")&&this.executeMethod("onTooltipHide",t)},didDestroy:function(){window.removeEventListener("scroll",this._toolscroll,!0),document.removeEventListener("mousemove",this.getData("eventListeners").mousemove,!0),document.removeEventListener("mousedown",this._mousedown,!0),document.removeEventListener("touchstart",this._mousedown),document.removeEventListener("keydown",this._keydown,!0);var t=this.data.tooltips;for(var e in t)delete t[e].nodeName1.tooltipSpan,delete t[e].nodeName1.tooltip,document.body.removeChild(t[e]);delete this.$node.trigger,delete this._toolscroll,delete this._mousedown,delete this._keydown,this.data.tooltips=[],this.data.eventListeners={},this.data.tooltips={}},propertySetting:function(t){if(e=t.getAttribute("lt-prop-tooltip-config")){var e=JSON.parse(e);for(var o in e)t.tooltip.config[o]=e[o]}},createTooltip:function(t,e,o){o?this.followcursor.call(this,t,e):this.nonFollowcursor.call(this,t,e),this.getData("ltPropKeepAlive")||1!=e.nodeName1.tooltip.config.keeptooltip&&"true"!=e.nodeName1.tooltip.config.keeptooltip&&(e.nodeName1.tooltip.maxdisp=setTimeout(function(){if(document.body.contains(e)){this.prevTooltipNode==e.nodeName1&&delete this.prevTooltipNode;var t=e.nodeName1;delete e.nodeName1.tooltipSpan,delete e.nodeName1.tooltip,document.body.removeChild(e),this.tooltipCloseCallback(t),delete this.data.tooltips[e._random]}}.bind(this),e.nodeName1.tooltip.config.maxdisplaytime))},followcursor:function(t,e){document.body.contains(e)&&(e._callbackHandled||(this.tooltipOpenCallback(e.nodeName1,e),e._callbackHandled=!0),e.classList.contains("lyteTooltipHidden")?(e.classList.remove("lyteTooltipHidden"),$L.fastdom.measure(this._followcursor.bind(this,t,e))):this._followcursor(t,e))},_followcursor:function(t,e){if(this.data.tooltips[e._random]){var o,i=e.getBoundingClientRect(),l=e.nodeName1.getBoundingClientRect(),s=(window.pageXOffset||document.documentElement.scrollLeft)*(this._dir?-1:1),n=window.pageYOffset||document.documentElement.scrollTop,a=window.innerWidth,r=window.innerHeight,d=Math.min(20,parseInt(e.nodeName1.tooltip.config.margin)),p=this.rtlfunc.call(this,"clientX",t,a),c=t.clientY+n+5+d;if(p+i.width>a)if(p-i.width>0)p-=i.width;else{var h=a-(this.rtlfunc("left",l,a)+l.width/2),m=a-h;p=h>i.width/2&&m>i.width/2?m-.5*i.width:Math.max(0,a-i.width),o=!0}e.style[this.rtlfunc.call(this,"left")]=p+s+"px",e.style.top=c+"px",o&&$L.fastdom.measure(function(){this.data.tooltips[e._random]&&(i=e.getBoundingClientRect()).bottom>r&&t.clientY>r-t.clientY&&(e.style.top=t.clientY-i.height-d-5+n+"px")}.bind(this))}},createsupp:function(t){var e=document.createElement("span");return e.classList.add("lyteTooltipInnerSpan"),t.classList.add("lyteInnerToolAdded"),t.appendChild(e)},rightalign:function(t,e,o,i,l,s,n,a,r,d,p,c,h){if(t+e<o+i.width)return l.classList.remove(r),s||this.nonFollowcursor(n,l,d,!0),!0;if(o<e){if(h)this.createsupp(l).style[a]=.75*c-p+"px";l.style[a]=0}else l.style[a]=o+"px"},nonFollowcursor:function(t,e,o,i){var l,s="callout"==e.nodeName1.tooltip.config.appearance;e.classList.remove("lyteTooltipHidden"),l=(o=o||e.nodeName1.tooltip.config.position)||"bottom",s&&e.classList.add("lyte"+l[0].toUpperCase()+l.slice(1)),e._callbackHandled||(this.tooltipOpenCallback(e.nodeName1,e),e._callbackHandled=!0),$L.fastdom.measure(function(){if(e.nodeName1.tooltip){var l,n=(window.pageXOffset||document.documentElement.scrollLeft)*(this._dir?-1:1),a=window.pageYOffset||document.documentElement.scrollTop,r=window.innerWidth,d=window.innerHeight,p=e.getBoundingClientRect(),c=e.nodeName1.getBoundingClientRect(),h=this.rtlfunc.call(this,"left",c,r)+n,m=c.top+a,u=Math.min(parseInt(e.nodeName1.tooltip.config.margin),20),f=e.offsetWidth,g=c.width,y=c.height,w=this.rtlfunc.call(this,"left"),b=window.getComputedStyle(e),v=/content-box/.test(b.boxSizing),L=v?parseFloat(b.paddingLeft):0,T=v?parseFloat(b.paddingRight):0;v&&parseFloat(b.paddingTop),v&&parseFloat(b.paddingBottom);switch(s?(l=parseFloat(window.getComputedStyle(e,":before").getPropertyValue("width"))/2*1.414,!isNaN(l)&&l||(l=parseFloat(window.getComputedStyle(e,"left"==o?":before":":after").getPropertyValue("border-left-width")))):l=0,o.toLowerCase()){case"right":var N=(h+=l)+g+u;if(e.style.top=m+y/2-p.height/2+"px",r+n<N+p.width){if(!i&&r-(h+g-n-l)<h-l-n){e.classList.remove("lyteRight"),this.nonFollowcursor.call(this,t,e,"left",!0);break}e.style[w]=N+"px",e.style.width=r-N-L-T+"px",$L.fastdom.mutate(function(){$L.fastdom.measure(function(){e.style.top=m+y/2-e.getBoundingClientRect().height/2+"px"})})}else e.style[w]=N+"px";break;case"left":N=(h-=l)-u-f;if(e.style.top=m+y/2-p.height/2+"px",N<n){if(!i&&h+l-n<r-(h+l-n+g)){e.classList.remove("lyteLeft"),this.nonFollowcursor.call(this,t,e,"right",!0);break}e.style[w]="0px",e.style.width=h-n-L-T+"px",$L.fastdom.mutate(function(){$L.fastdom.measure(function(){e.style.top=m+y/2-e.getBoundingClientRect().height/2+"px"})})}else e.style[w]=N+"px";break;case"bottom":N=h+g/2-f/2;if(a+d<(k=(m+=l)+y+u)+p.height&&(e.classList.remove("lyteBottom"),!i)){this.nonFollowcursor.call(this,t,e,"top",!0);break}N=this.horicheck(N,n,r,p,e,c,w,l,s),e.style[w]=N+"px",e.style.top=k+"px";break;case"top":N=h+g/2-f/2;if((k=(m-=l)-u-e.clientHeight)<a&&(e.classList.remove("lyteTop"),!i)){this.nonFollowcursor.call(this,t,e,"bottom",!0);break}N=this.horicheck(N,n,r,p,e,c,w,l,s),e.style[w]=N+"px",$L.fastdom.mutate(function(){$L.fastdom.measure(function(){e.style.top=m-u-e.getBoundingClientRect().height+"px"})});break;case"bottomright":N=h+.75*g-.2*f;var k=(m+=l)+y+u;if(this.rightalign(r,n,N,p,e,i,t,w,"lyteBottomright","bottomleft",l,g,s))break;if(d+a<k+p.height){e.classList.remove("lyteBottomright"),i||this.nonFollowcursor.call(this,t,e,"topright",!0);break}e.style.top=k+"px";break;case"topright":N=h+.75*g-.2*f,k=(m-=l)-e.clientHeight-u;if(this.rightalign(r,n,N,p,e,i,t,w,"lyteTopright","topleft",l,g,s))break;if(k<a){e.classList.remove("lyteTopright"),i||this.nonFollowcursor.call(this,t,e,"bottomright",!0);break}e.style.top=k+"px";break;case"bottomleft":N=h-.8*f+.25*g+"px",k=(m+=l)+y+u+"px";if(parseInt(N)<n){e.classList.remove("lyteBottomleft"),i||this.nonFollowcursor.call(this,t,e,"bottomright",!0);break}if(e.style[w]=N,d+a<parseInt(k)+p.height){e.classList.remove("lyteBottomleft"),i||this.nonFollowcursor.call(this,t,e,"topleft",!0);break}e.style.top=k;break;case"topleft":N=h-.8*f+.25*g+"px",k=(m-=l)-parseInt(e.clientHeight)-u+"px";if(parseInt(N)<n){e.classList.remove("lyteTopleft"),i||this.nonFollowcursor.call(this,t,e,"topright",!0);break}if(e.style[w]=N,parseInt(k)<a){e.classList.remove("lyteTopleft"),i||this.nonFollowcursor.call(this,t,e,"bottomleft",!0);break}e.style.top=k;break;default:var x=l;N=this.rtlfunc.call(this,"clientX",t,r)-f/2;if(d+a<(k=m+x+y+u)+p.height&&(e.classList.remove("lyteBottom"),!i)){this.nonFollowcursor.call(this,t,e,"top",!0);break}N=this.horicheck(N,n,r,p,e,c,w,l,s),e.style[w]=N+"px",e.style.top=k+"px"}e.style[this.rtlfunc("right")]="auto"}}.bind(this))},horicheck:function(t,e,o,i,l,s,n,a,r){var d,p;if(t<e?(t=e,d=!0):o+e<t+i.width&&(t=o-i.width+e,p=!0),(d||p)&&r){var c=this.createsupp(l);this.rtlfunc("left",s,o);if(d){var h=this.rtlfunc("left",s,o);c.style[n]=(s.width+Math.min(h,0))/2+Math.max(0,h)+"px"}else{var m=o-this.rtlfunc("right",s,o);c.style[n]=i.width-(Math.max(0,m)+(s.width+Math.min(m,0))/2)+"px"}}return t},closeAllTooltip:function(t){for(var e=document.body.children,o=0;o<e.length;o++)e[o].classList.contains("lyteTooltip")&&e[o].nodeName1!=t&&(e[o].nodeName1.tooltip.bodyTimeout=setTimeout(this.removeTooltip.bind(this),e[o].nodeName1.tooltip.config.hidedelay,e[o],event))},removeTooltip:function(t,e){if(document.body.contains(t)){clearTimeout(t.nodeName1.tooltip.disptime),clearTimeout(t.nodeName1.tooltip.maxdisp),clearTimeout(t.nodeName1.tooltip.settime),clearTimeout(t.nodeName1.tooltip.maxdisp),this.prevTooltipNode==t.nodeName1&&delete this.prevTooltipNode;var o=t.nodeName1;delete t.nodeName1.tooltipSpan,delete t.nodeName1.tooltip,document.body.removeChild(t),this.tooltipCloseCallback(o),delete this.data.tooltips[t._random]}},mousemove:function(t){if(!this._mousedownFlag){for(var e=t.target.correspondingElement||t.target;e&&"BODY"!=e.tagName&&e!=document&&"HTML"!=e.tagName;){if(e.getAttribute&&e.getAttribute("lt-prop-title")){if(e.getAttribute("title")&&e.removeAttribute("title"),e.hasOwnProperty("tooltip")||(e.tooltip={}),e.tooltip.config={position:"",appearance:"callout",margin:0,showdelay:0,hidedelay:0,maxdisplaytime:5e3,keeptooltip:!1,aria:!1},e.tooltip.title=e.getAttribute("lt-prop-title"),this.propertySetting.call(this,e),this.prevTooltipNode==e||e.tooltip.tooltipSpan)if("followcursor"==e.tooltip.config.position&&this.prevTooltipNode==e&&e.tooltip.tooltipSpan){o=e.tooltip.tooltipSpan;clearTimeout(o.nodeName1.tooltip.maxdisp),clearTimeout(o.nodeName1.tooltip.settime),o._callbackHandled?this.followcursor.call(this,t,o):o.nodeName1.tooltip.settime=setTimeout(this.createTooltip.bind(this),o.nodeName1.tooltip.config.showdelay,t,o,!0)}else e.tooltip.tooltipSpan&&"none"==e.tooltip.tooltipSpan.style.display?(e.tooltip.tooltipSpan.style.display="",clearTimeout(e.tooltip.maxdisp),clearTimeout(e.tooltip.settime),clearTimeout(e.tooltip.bodyTimeout),e.tooltip.settime=setTimeout(this.createTooltip.bind(this),e.tooltip.config.showdelay,t,e.tooltip.tooltipSpan,"followcursor"==e.tooltip.config.position)):this.prevTooltipNode=e;else{this.prevTooltipNode=e;var o=document.createElement("span"),i=e.getAttribute("lt-prop-tooltip-class"),l=this.getData("ltPropId"),s=this.getData("ltPropClass"),n=Date.now()+"lytetooltip";if(this.data.tooltips[n]=o,o._random=n,l&&o.setAttribute("id",l),s&&o.classList.add(s),o.classList.add("lyteTooltip"),this.direction&&o.classList.add("lyteRTL"),o.classList.add("lyteTooltipHidden"),e.getAttribute("lt-prop-tooltip-style")&&(o.setAttribute("style",e.getAttribute("lt-prop-tooltip-style")),o.style.borderColor||(o.style.borderColor=o.style.backgroundColor)),"callout"==e.tooltip.config.appearance&&"followcursor"!=e.tooltip.config.position&&o.classList.add("lyteTooltipCallout"),e.tooltip.tooltipSpan=o,o.nodeName1=e,i)for(var a=i.split(" "),r=0;r<a.length;r++)o.classList.add(a[r]);e.tooltip.aria&&o.setAttribute("role","tooltip"),e.tooltip.settime=setTimeout(this.createTooltip.bind(this),o.nodeName1.tooltip.config.showdelay,t,o,"followcursor"==o.nodeName1.tooltip.config.position),o.textContent=o.nodeName1.tooltip.title,document.body.appendChild(o)}this.closeAllTooltip.call(this,e);break}e=e.parentNode}e&&-1!=["BODY","HTML"].indexOf(e.tagName)&&this.prevTooltipNode!=e&&(delete this.prevTooltipNode,this.closeAllTooltip.call(this))}}}),"complete"==document.readyState||"interactive"==document.readyState?document.body.querySelectorAll("lyte-tooltip").length||document.body.appendChild(document.createElement("lyte-tooltip")):document.addEventListener("DOMContentLoaded",function(t){document.body.querySelectorAll("lyte-tooltip").length||document.body.appendChild(document.createElement("lyte-tooltip"))});