function stepResize(t){clearTimeout(window._stepresize),window._stepresize=setTimeout(function(){delete window._stepresize;for(var t=document.getElementsByTagName("lyte-step"),e=0;e<t.length;e++){var a=t[e].component;"advanced"==a.data.ltPropType&&a._measureWidth(a.constructForward)}})}Lyte.Component.register("lyte-step",{_template:'<template tag-name="lyte-step">\n\t<div onclick="{{action(\'divClick\', event, this)}}">\n\t\t<template is="if" value="{{expHandlers(ltPropType,\'!=\',&quot;advanced&quot;)}}"><template case="true"><template is="if" value="{{expHandlers(ltPropYield,\'==\',false)}}"><template case="true">\n\t\t\t\t\t<lyte-step-structure class="{{ltPropClass}}" onclick="{{action(\'divClick\', event, this)}}">\n\t\t\t\t\t\t<template is="for" items="{{ltPropData}}" item="array" index="indexVal"><template is="if" value="{{expHandlers(lyteUiIsObject(array),\'==\',false)}}"><template case="true"><template is="if" value="{{expHandlers(ltPropClass,\'==\',\'lyteStepBullet\')}}"><template case="true">\n\t\t\t\t \t\t\t\t\t\t\t  <lyte-step-item sporder="{{indexVal}}" onclick="{{action(\'onclick\', event, this, array)}}"> \t  <lyte-step-body> {{array}} </lyte-step-body> \n\t\t\t\t \t\t\t\t\t\t\t\t\t<lyte-step-head>{{indexVal}}</lyte-step-head>\n\t\t\t\t \t\t\t\t\t\t\t\t</lyte-step-item>\n\t\t\t\t \t\t\t\t\t\t\t</template><template case="false"> \n\t\t\t\t\t\t\t\t\t\t\t  <lyte-step-item sporder="{{indexVal}}" onclick="{{action(\'onclick\', event, this, array)}}"> \t <lyte-step-body> {{array}} </lyte-step-body>\n\t\t\t\t\t\t\t\t\t\t\t\t</lyte-step-item>\n\t\t\t\t\t\t\t\t\t\t </template></template></template><template case="false"><template is="if" value="{{expHandlers(ltPropClass,\'==\',\'lyteStepBullet\')}}"><template case="true">\n\t\t\t\t\t\t\t\t\t\t\t\t<lyte-step-item sporder="{{indexVal}}" onclick="{{action(\'onclick\', event, this, array)}}"> \t\n\t\t\t\t\t\t\t\t\t\t\t\t\t<lyte-step-body> {{array[ltPropLabel]}} </lyte-step-body> \n\t\t\t\t\t\t\t\t\t\t\t\t\t<lyte-step-head>{{array[ltPropOption]}}</lyte-step-head>\n\t\t\t\t\t\t\t\t\t\t\t\t</lyte-step-item>\n\t\t\t\t\t\t\t\t\t\t\t</template><template case="false"> \n\t\t\t\t\t\t\t\t\t\t\t   <lyte-step-item sporder="{{indexVal}}" onclick="{{action(\'onclick\', event, this, array)}}"> \t\n\t\t\t\t\t\t\t\t\t\t\t   \t    <lyte-step-body> {{array[ltPropLabel]}} </lyte-step-body>\n\t\t\t\t\t\t\t\t\t\t\t   </lyte-step-item>\n\t\t\t\t\t\t\t\t\t\t  </template></template></template></template></template>\n\t\t\t\t\t</lyte-step-structure>\t\n\t\t\t</template><template case="false">\n\t\t\t\t\t\t<lyte-yield yield-name="yield"></lyte-yield>\n\t\t\t</template></template></template><template case="false">\n\t\t\t<lyte-yield class="lyteStepAdvanced" yield-name="yield" lt-prop-content="{{dummyContent}}"></lyte-yield>\n\t\t</template></template>\n\t</div>\t\t\n</template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1,1]},{type:"componentDynamic",position:[1,1]},{type:"text",position:[1,3,0]},{type:"componentDynamic",position:[1,3]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1,1]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1,1]},{type:"componentDynamic",position:[1,1]},{type:"text",position:[1,3,0]},{type:"componentDynamic",position:[1,3]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1,1]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"insertYield",position:[1]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"insertYield",position:[1]}]}},default:{}}],_observedAttributes:["ltPropClass","ltPropData","ltPropSelected","ltPropSkip","ltPropActiveClass","ltPropCompletedClass","ltPropWarningClass","ltPropKeepMarked","ltPropYield","ltPropLabel","ltPropOption","ltPropType","ltPropOffset","ltPropIndex","ltPropDataType","dummyContent","widthArr","divWidth","forwardWidth","backwardWidth"],init:function(){this.getMethods("beforeRender")&&this.executeMethod("beforeRender",this.$node)},didDestroy:function(){delete this.$node.next,delete this.$node.previous,delete this.$node.goto,delete this._finalCallback,delete this._transEnd,clearTimeout(this._animetime)},didConnect:function(){var t="advanced"==this.getData("ltPropType");this.$node.next=function(t){this.$node.goto(this.data.ltPropSelected+1,t,!0)}.bind(this),this.$node.previous=function(t){this.$node.goto(this.data.ltPropSelected-1,t,!0)}.bind(this),this.$node.goto=t?function(t,e,a){(this.getData("ltPropSkip")||a)&&this.moveTo(t,e,this.getData("ltPropSelected"))}.bind(this):function(t,e,a){if(this.component.getData("ltPropSkip")||a){var i=this.querySelectorAll("lyte-step-item"),s=this.component.getData("ltPropSelected"),n=this.component.getData("ltPropWarningClass"),o=i[s],r=this.component.getData("ltPropCompletedClass"),l=this.component.getData("ltPropActiveClass");t>=-1&&i.length&&("incomplete"==e?o.classList.add(n):o.classList.add(r),o.classList.remove(l),t==i.length?t--:-1==t&&t++,i[t].classList.add(l),t==s?(o.classList.remove(n),o.classList.remove(r)):this.component.setData("ltPropSelected",t))}},$L.fastdom.measure(function(){var t=_lyteUiUtils.getRTL();$L.fastdom.mutate(function(){t&&this.$node.classList.add("lyteRTL"),this.breadcrumbClass.call(this)}.bind(this))}.bind(this)),t?this.getMethods("afterRender")&&(this._finalCallback=this.executeMethod.bind(this,this.$node)):this.getMethods("afterRender")&&this.executeMethod("afterRender",this.$node),this._transEnd=this.transfade.bind(this)},selectedElementFindObs:function(t){if("advanced"!=this.getData("ltPropType"))$L.fastdom.mutate(this.selectedElementFind.bind(this));else if(t&&!this._preventselect){this.$node.goto(t.newValue,"",!0);var e=this.getData("ltPropIndex");(t.newValue<e||t.newValue>e+this.getData("dummyContent").length)&&(this._enableAnimate=!0,this.setData("ltPropIndex",t.newValue))}}.observes("ltPropSelected").on("didConnect"),selectedElementFind:function(){var t=parseInt(this.getData("ltPropSelected")),e=this.getData("ltPropActiveClass"),a=this.$node.querySelectorAll("lyte-step-item"),i=this.getData("ltPropCompletedClass"),s=this.getData("ltPropWarningClass");if(a.length){for(var n=this.getData("ltPropKeepMarked")?t:a.length-1,o=0;o<a.length;o++)a[o].classList.remove(e);a[t].classList.add(e),a[t].classList.remove(s),a[t].classList.remove(i);for(var r=0;r<=n;r++)r<t?a[r].classList.contains(s)||a[r].classList.add(i):r>t&&(a[r].classList.remove(s),a[r].classList.remove(i))}},ArrayContentChangeObs:function(){this.ArrayContentChange.call(this)}.observes("ltPropData.[]","ltPropData"),ArrayContentChange:function(){void 0==this.getData("ltPropSelected")?this.setData("ltPropSelected",0):this.selectedElementFind.call(this)},breadcrumbClassObs:function(){this.breadcrumbClass.call(this)}.observes("ltPropClass"),breadcrumbClass:function(){"advanced"!=this.getData("ltPropType")&&this.data.ltPropYield&&this.data.ltPropClass&&this.$node.querySelector("lyte-step-structure").classList.add(this.data.ltPropClass)},data:function(){return{ltPropClass:Lyte.attr("string",{default:"lyteStepSlash"}),ltPropData:Lyte.attr("array",{default:[]}),ltPropSelected:Lyte.attr("number",{default:0}),ltPropSkip:Lyte.attr("boolean",{default:!0}),ltPropActiveClass:Lyte.attr("string",{default:"lyteActive"}),ltPropCompletedClass:Lyte.attr("string",{default:"lyteCompleted"}),ltPropWarningClass:Lyte.attr("string",{default:"lyteWarning"}),ltPropKeepMarked:Lyte.attr("boolean",{default:!1}),ltPropYield:Lyte.attr("boolean",{default:!1}),ltPropLabel:Lyte.attr("string",{default:""}),ltPropOption:Lyte.attr("string",{default:""}),ltPropType:Lyte.attr("string",{default:void 0}),ltPropOffset:Lyte.attr("number",{default:0}),ltPropIndex:Lyte.attr("number",{default:0}),ltPropDataType:Lyte.attr("array",{default:[]}),dummyContent:Lyte.attr("array",{default:[]}),widthArr:Lyte.attr("array",{default:[]}),divWidth:Lyte.attr("number",{default:0}),forwardWidth:Lyte.attr("number",{default:0}),backwardWidth:Lyte.attr("number",{default:0})}},actions:{onclick:function(t,e,a){if((1==t.ctrlKey||1==t.metaKey||2==t.which)&&void 0!=t.target.href&&-1!=t.target.href.indexOf("javascript:")&&"_blank"==t.target.target)return!1;this.getMethods("onClick")&&(this.executeMethod("onClick",e,this.$node,t,a),t.stopPropagation())},divClick:function(t,e){if("advanced"!=this.getData("ltPropType")){if((1==t.ctrlKey||1==t.metaKey||2==t.which)&&void 0!=t.target.href&&-1!=t.target.href.indexOf("javascript:")&&"_blank"==t.target.target)return!1;if(this.getMethods("onClick")&&this.getData("ltPropYield"))for(var a=t.target.correspondingElement||t.target;a&&a!=e;){if("LYTE-STEP-ITEM"==a.tagName){this.executeMethod("onClick",a,this.$node,t,a.getAttribute("data-value"));break}a=a.parentNode}}else{if(this._transstart)return;var i=$L(t.target).closest("lyte-step-forward");if(i.length){if(this.getMethods("onBeforeNavigate")&&0==this.executeMethod("onBeforeNavigate","forward",this.getData("ltPropIndex"),this.$node))return;this._enableAnimate=!0,this.setData("ltPropIndex",Math.max(0,this.getData("ltPropIndex")+this.getData("dummyContent").length)),this.getMethods("onNavigate")&&(this._finalCallback=this.executeMethod.bind(this,"onNavigate","forward",this.getData("ltPropIndex"),this.$node))}else if((i=$L(t.target).closest("lyte-step-backward")).length){if(this.getMethods("onBeforeNavigate")&&0==this.executeMethod("onBeforeNavigate","backward",this.getData("ltPropIndex"),this.$node))return;this._transstart=!0,this._transendback=this.constructBackward,$L("lyte-step-structure",this.$node).on("transitionend",this._transEnd).addClass("lyteStepFade"),this.timeout(),this.getMethods("onNavigate")&&(this._finalCallback=this.executeMethod.bind(this,"onNavigate","backward",this.getData("ltPropIndex"),this.$node))}else{if((1==t.ctrlKey||1==t.metaKey||2==t.which)&&void 0!=t.target.href&&-1!=t.target.href.indexOf("javascript:")&&"_blank"==t.target.target)return!1;(i=$L(t.target).closest("lyte-step-item")).length&&this.getMethods("onClick")&&this.executeMethod("onClick",i.get(0),this.$node,t,i.attr("data-value"))}}}},forwardAdd:function(t,e,a,i,s,n){for(var o=t;o<e.length;o++){if(i+e[o]>a){o--;break}i+=e[o],s.push(n[o])}return{consWid:i,i:o}},backwardAdd:function(t,e,a,i,s,n){for(var o=t-1;o>=0&&!(i+e[o]>a);o--)i+=e[o],s.unshift(n[o]),t=o;return{consWid:i,min:t}},constructBackward:function(t,e){t=t||$L("lyte-step-forward").get(0),e=e||$L("lyte-step-backward").get(0);var a,i=this.getData("ltPropData"),s=Math.min(i.length,this.getData("ltPropIndex")+this.getData("ltPropOffset")),n=0,o=[],r=this.getData("widthArr"),l=this.getData("forwardWidth"),d=this.getData("backwardWidth"),p=this.getData("divWidth");(n+=d,n=(a=this.backwardAdd(s,r,p,n,o,i)).consWid,0==(s=a.min)&&(n-=d,e&&e.classList.add("lyteStepHidden")),n<p)&&(n=(a=this.forwardAdd(s+o.length,r,p,n,o,i)).consWid);if(s+o.length<i.length)for(t&&t.classList.remove("lyteStepHidden"),n+=l;n>p&&o.length;)n-=r[s+o.length],o.pop();this._prevent=!0,this.setData("ltPropIndex",s),delete this._prevent,this._arr=o,this.transend()},transend:function(){this.setData("dummyContent",this._arr),delete this._arr,this._finalCallback&&(this._finalCallback(),delete this._finalCallback),this.moveTo(this.getData("ltPropSelected"),"",this.getData("ltPropSelected"),this.getData("ltPropIndex")+this.getData("dummyContent").length==this.getData("ltPropData").length),$L(".lyteStepFade",this.$node).removeClass("lyteStepFade")},constructForward:function(t,e){t=t||$L("lyte-step-forward").get(0),e=e||$L("lyte-step-backward").get(0);var a=Math.max(0,this.getData("ltPropIndex")-this.getData("ltPropOffset")),i=0,s=[],n=this.getData("widthArr"),o=this.getData("forwardWidth"),r=this.getData("backwardWidth"),l=this.getData("divWidth"),d=this.getData("ltPropData");0!=a?(i+=r,e&&e.classList.remove("lyteStepHidden")):e&&e.classList.add("lyteStepHidden");var p=this.forwardAdd(a,n,l,i,s,d),h=p.i;if(i=p.consWid,h<n.length){for(;i+o>l&&h;)i-=n[h],h--,s.pop();t&&t.classList.remove("lyteStepHidden")}else t&&t.classList.add("lyteStepHidden"),i<l&&(i=(p=this.backwardAdd(a,n,l,i,s,d)).consWid,a=p.min),0==a&&this.getData("ltPropIndex")&&(i-=r,i=this.forwardAdd(a+s.length,n,l,i,s,d));this._prevent=!0,this.setData("ltPropIndex",a),delete this._prevent,this._arr=s,this.transend()},measureWidth:function(){"advanced"==this.getData("ltPropType")&&this._measureWidth(this.constructForward)}.on("didConnect"),indexObs:function(t){this._prevent||(this._enableAnimate?(this._transstart=!0,delete this._enableAnimate,this.timeout(),$L("lyte-step-structure",this.$node).on("transitionend",this._transEnd).addClass("lyteStepFade")):this._measureWidth(this.constructForward))}.observes("ltPropIndex","ltPropData","ltPropData.[]"),_measureWidth:function(t){if("advanced"==this.getData("ltPropType")){var e=[],a=this.getData("ltPropData");this.setData("dummyContent",a);var i=$L("lyte-step-forward").get(0),s=$L("lyte-step-backward").get(0);i&&i.classList.remove("lyteStepHidden"),s&&s.classList.remove("lyteStepHidden"),$L.fastdom.measure(function(){for(var a=$L("lyte-step-item",this.$node),n=0;n<a.length;n++){var o=window.getComputedStyle(a.get(n));e[n]=a.get(n).getBoundingClientRect().width+parseFloat(o.marginLeft)+parseFloat(o.marginRight)}var r=this.$node.querySelector("lyte-step-structure").getBoundingClientRect().width,l=0,d=0;if(i){l=i.getBoundingClientRect().width;var p=getComputedStyle(i);l+=parseFloat(p.marginRight)+parseFloat(p.marginLeft)}if(s){d=s.getBoundingClientRect().width;p=getComputedStyle(s);d+=parseFloat(p.marginRight)+parseFloat(p.marginLeft)}this.setData({divWidth:r,widthArr:e,forwardWidth:l,backwardWidth:d}),$L.fastdom.mutate(t.bind(this,i,s))}.bind(this))}},moveTo:function(t,e,a,i){this._preventselect=!0;var s=this.getData("ltPropData"),n=(this.getData("dummyContent"),this.getData("ltPropIndex")),o=this.getData("ltPropDataType"),r=$L("lyte-step-item",this.$node),l=this.getData("ltPropActiveClass"),d=this.getData("ltPropCompletedClass"),p=this.getData("ltPropWarningClass"),h=this.getData("ltPropKeepMarked");if(i&&r.eq(-1).addClass("lyteStepLast"),t=Math.min(Math.max(0,t||0),s.length-1),void 0==a){for(var c=0;c<s.length;c++)"active"==o[c]&&(a=c);void 0==a&&(this.setData("ltPropSelected",0),a=0)}for(c=0;c<s.length;c++){var m,y=void 0==o[c]?"insertAt":"replaceAt";m=t!=a&&t>a&&c>=a&&c<t?"incomplete"==e?"incomplete":"completed":c==t?"active":c>t?h&&o[c]||"":c>a?"incomplete"==e?"incomplete":"completed":("active"==o[c]?"completed":o[c])||"completed",Lyte.arrayUtils(o,y,c,m),c>=n&&("active"==o[c]?r.eq(c-n).removeClass(d,p).addClass(l):"incomplete"==o[c]?r.eq(c-n).removeClass(d,l).addClass(p):"completed"==o[c]?r.eq(c-n).removeClass(l,p).addClass(d):r.eq(c-n).removeClass(d,l,p))}this.setData("ltPropSelected",t),delete this._preventselect},transfade:function(){clearTimeout(this._animetime),delete this._animetime,delete this._transstart,this._measureWidth(this._transendback||this.constructForward),delete this._transendback,$L(".lyteStepFade",this.$node).off("transitionend")},returntran:function(t){var e=0;if(/(.+)(s|ms)$/.test(t)){var a=t.match(/(.+)(s|ms)$/);e=parseFloat(a[1])*("s"==a[2]?1e3:1)}return e},timeout:function(){var t=$L("lyte-step-structure",this.$node).get(0),e=window.getComputedStyle(t);this._animetime=setTimeout(this._transEnd,10+this.returntran(e.transitionDuration)+this.returntran(e.transitionDelay))}}),window.addEventListener("resize",stepResize,!0),window.addEventListener("orientationchange",stepResize,!0);